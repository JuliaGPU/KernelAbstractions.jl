<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · KernelAbstractions.jl</title><link rel="canonical" href="https://juliagpu.github.io/KernelAbstractions.jl/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">KernelAbstractions.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Quickstart-1"><span>Quickstart</span></a></li><li><a class="tocitem" href="#Important-differences-to-Julia-1"><span>Important differences to Julia</span></a></li><li><a class="tocitem" href="#Important-differences-to-CUDA.jl/AMDGPU.jl-1"><span>Important differences to CUDA.jl/AMDGPU.jl</span></a></li><li><a class="tocitem" href="#Important-differences-to-GPUifyLoops.jl-1"><span>Important differences to GPUifyLoops.jl</span></a></li><li><a class="tocitem" href="#How-to-debug-kernels-1"><span>How to debug kernels</span></a></li><li><a class="tocitem" href="#How-to-profile-kernels-1"><span>How to profile kernels</span></a></li></ul></li><li><a class="tocitem" href="kernels/">Writing kernels</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="examples/memcopy/">Memcopy</a></li><li><a class="tocitem" href="examples/memcopy_static/">Memcopy with static NDRange</a></li><li><a class="tocitem" href="examples/naive_transpose/">Naive Transpose</a></li><li><a class="tocitem" href="examples/performance/">Measuring performance</a></li><li><a class="tocitem" href="examples/matmul/">Matmul</a></li></ul></li><li><a class="tocitem" href="api/">API</a></li><li><span class="tocitem">Extras</span><ul><li><a class="tocitem" href="extras/unrolling/">Unroll macro</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="KernelAbstractions-1"><a class="docs-heading-anchor" href="#KernelAbstractions-1">KernelAbstractions</a><a class="docs-heading-anchor-permalink" href="#KernelAbstractions-1" title="Permalink"></a></h1><p><code>KernelAbstractions.jl</code> is a package that allows you to write GPU-like kernels that target different execution backends. It is intended to be a minimal, and performant library that explores ways to best write heterogenous code.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>While <code>KernelAbstraction.jl</code> is focused on performance portability, it is GPU-biased and therefore the kernel language has several constructs that are necessary for good performance on the GPU, but may hurt performance on the CPU.</p></div></div><h2 id="Quickstart-1"><a class="docs-heading-anchor" href="#Quickstart-1">Quickstart</a><a class="docs-heading-anchor-permalink" href="#Quickstart-1" title="Permalink"></a></h2><h3 id="Writing-your-first-kernel-1"><a class="docs-heading-anchor" href="#Writing-your-first-kernel-1">Writing your first kernel</a><a class="docs-heading-anchor-permalink" href="#Writing-your-first-kernel-1" title="Permalink"></a></h3><p>Kernel functions have to be marked with the <a href="api/#KernelAbstractions.@kernel"><code>@kernel</code></a>. Inside the <code>@kernel</code> macro you can use the <a href="api/#api_kernel_language-1">kernel language</a>. As an example the <code>mul2</code> kernel below will multiply each element of the array <code>A</code> by <code>2</code>. It uses the <a href="api/#KernelAbstractions.@index"><code>@index</code></a> macro to obtain the global linear index of the current workitem.</p><pre><code class="language-julia">@kernel function mul2(A)
  I = @index(Global)
  A[I] = 2 * A[I]
end</code></pre><h3 id="Launching-your-first-kernel-1"><a class="docs-heading-anchor" href="#Launching-your-first-kernel-1">Launching your first kernel</a><a class="docs-heading-anchor-permalink" href="#Launching-your-first-kernel-1" title="Permalink"></a></h3><p>You can construct a kernel for a specific backend by calling the kernel function with the first argument being the device kind, the second argument being the size of the workgroup and the third argument being a static <code>ndrange</code>. The second and third argument are optional. After instantiating the kernel you can launch it by calling the kernel object with the right arguments and some keyword arguments that configure the specific launch. The example below creates a kernel with a static workgroup size of <code>16</code> and a dynamic <code>ndrange</code>. Since the <code>ndrange</code> is dynamic it has to be provided for the launch as a keyword argument.</p><pre><code class="language-julia">A = ones(1024, 1024)
kernel = mul2(CPU(), 16)
event = kernel(A, ndrange=size(A))
wait(event)
all(A .== 2.0)</code></pre><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>All kernel launches are asynchronous, each kernel produces an event token that has to be waited upon, before reading or writing memory that was passed as an argument to the kernel. See <a href="kernels/#dependencies-1">dependencies</a> for a full explanation.</p></div></div><p>If you have a GPU attached to your machine, it&#39;s equally as easy to launch your kernel on it instead. For example, launching on a CUDA GPU:</p><pre><code class="language-julia">using CUDAKernels # Required to access CUDADevice
A = CUDA.ones(1024, 1024)
kernel = mul2(CUDADevice(), 16)
# ... the rest is the same!</code></pre><p>AMDGPU (ROCm) support is also available via the ROCKernels.jl package, although at this time it is considered experimental. Ping <code>@jpsamaroo</code> in any issues specific to the ROCKernels backend.</p><h2 id="Important-differences-to-Julia-1"><a class="docs-heading-anchor" href="#Important-differences-to-Julia-1">Important differences to Julia</a><a class="docs-heading-anchor-permalink" href="#Important-differences-to-Julia-1" title="Permalink"></a></h2><ol><li>Functions inside kernels are forcefully inlined, except when marked with <code>@noinline</code>.</li><li>Floating-point multiplication, addition, subtraction are marked contractable.</li></ol><h2 id="Important-differences-to-CUDA.jl/AMDGPU.jl-1"><a class="docs-heading-anchor" href="#Important-differences-to-CUDA.jl/AMDGPU.jl-1">Important differences to CUDA.jl/AMDGPU.jl</a><a class="docs-heading-anchor-permalink" href="#Important-differences-to-CUDA.jl/AMDGPU.jl-1" title="Permalink"></a></h2><ol><li>The kernels are automatically bounds-checked against either the dynamic or statically provided <code>ndrange</code>.</li><li>Functions like <code>Base.sin</code> are mapped to <code>CUDA.sin</code>/<code>AMDGPU.sin</code>.</li></ol><h2 id="Important-differences-to-GPUifyLoops.jl-1"><a class="docs-heading-anchor" href="#Important-differences-to-GPUifyLoops.jl-1">Important differences to GPUifyLoops.jl</a><a class="docs-heading-anchor-permalink" href="#Important-differences-to-GPUifyLoops.jl-1" title="Permalink"></a></h2><ol><li><code>@scratch</code> has been renamed to <code>@private</code>, and the semantics have changed. Instead of denoting how many dimensions are implicit on the GPU, you only ever provide the explicit number of dimensions that you require. The implicit CPU dimensions are appended.</li></ol><h2 id="How-to-debug-kernels-1"><a class="docs-heading-anchor" href="#How-to-debug-kernels-1">How to debug kernels</a><a class="docs-heading-anchor-permalink" href="#How-to-debug-kernels-1" title="Permalink"></a></h2><p><em>TODO</em></p><h2 id="How-to-profile-kernels-1"><a class="docs-heading-anchor" href="#How-to-profile-kernels-1">How to profile kernels</a><a class="docs-heading-anchor-permalink" href="#How-to-profile-kernels-1" title="Permalink"></a></h2><p><em>TODO</em></p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="kernels/">Writing kernels »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 3 June 2022 02:26">Friday 3 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
