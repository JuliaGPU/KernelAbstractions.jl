<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · KernelAbstractions.jl</title><meta name="title" content="API · KernelAbstractions.jl"/><meta property="og:title" content="API · KernelAbstractions.jl"/><meta property="twitter:title" content="API · KernelAbstractions.jl"/><meta name="description" content="Documentation for KernelAbstractions.jl."/><meta property="og:description" content="Documentation for KernelAbstractions.jl."/><meta property="twitter:description" content="Documentation for KernelAbstractions.jl."/><meta property="og:url" content="https://juliagpu.github.io/KernelAbstractions.jl/api/"/><meta property="twitter:url" content="https://juliagpu.github.io/KernelAbstractions.jl/api/"/><link rel="canonical" href="https://juliagpu.github.io/KernelAbstractions.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">KernelAbstractions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quickstart/">Quickstart</a></li><li><a class="tocitem" href="../kernels/">Writing kernels</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/memcopy/">Memcopy</a></li><li><a class="tocitem" href="../examples/memcopy_static/">Memcopy with static NDRange</a></li><li><a class="tocitem" href="../examples/naive_transpose/">Naive Transpose</a></li><li><a class="tocitem" href="../examples/performance/">Measuring performance</a></li><li><a class="tocitem" href="../examples/matmul/">Matmul</a></li><li><a class="tocitem" href="../examples/numa_aware/">NUMA-aware SAXPY</a></li><li><a class="tocitem" href="../examples/atomix/">Atomic operations with Atomix.jl</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#api_kernel_language"><span>Kernel language</span></a></li><li><a class="tocitem" href="#Host-language"><span>Host language</span></a></li><li><a class="tocitem" href="#Internal"><span>Internal</span></a></li></ul></li><li><span class="tocitem">Extras</span><ul><li><a class="tocitem" href="../extras/unrolling/">Unroll macro</a></li></ul></li><li><a class="tocitem" href="../implementations/">Notes for implementations</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/main/docs/src/api.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><h2 id="api_kernel_language"><a class="docs-heading-anchor" href="#api_kernel_language">Kernel language</a><a id="api_kernel_language-1"></a><a class="docs-heading-anchor-permalink" href="#api_kernel_language" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.@kernel" href="#KernelAbstractions.@kernel"><code>KernelAbstractions.@kernel</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@kernel function f(args) end</code></pre><p>Takes a function definition and generates a <a href="#KernelAbstractions.Kernel"><code>Kernel</code></a> constructor from it. The enclosed function is allowed to contain kernel language constructs. In order to call it the kernel has first to be specialized on the backend and then invoked on the arguments.</p><p><strong>Kernel language</strong></p><ul><li><a href="#KernelAbstractions.@Const"><code>@Const</code></a></li><li><a href="#KernelAbstractions.@index"><code>@index</code></a></li><li><a href="#KernelAbstractions.@groupsize"><code>@groupsize</code></a></li><li><a href="#KernelAbstractions.@ndrange"><code>@ndrange</code></a></li><li><a href="#KernelAbstractions.@localmem"><code>@localmem</code></a></li><li><a href="#KernelAbstractions.@private"><code>@private</code></a></li><li><a href="#KernelAbstractions.@uniform"><code>@uniform</code></a></li><li><a href="#KernelAbstractions.@synchronize"><code>@synchronize</code></a></li><li><a href="#KernelAbstractions.@print"><code>@print</code></a></li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs">@kernel function vecadd(A, @Const(B))
    I = @index(Global)
    @inbounds A[I] += B[I]
end

A = ones(1024)
B = rand(1024)
vecadd(CPU(), 64)(A, B, ndrange=size(A))
synchronize(backend)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL18-L51">source</a></section><section><div><pre><code class="language-julia hljs">@kernel config function f(args) end</code></pre><p>This allows for two different configurations:</p><ol><li><code>cpu={true, false}</code>: Disables code-generation of the CPU function. This relaxes semantics such that KernelAbstractions primitives can be used in non-kernel functions.</li><li><code>inbounds={false, true}</code>: Enables a forced <code>@inbounds</code> macro around the function definition in the case the user is using too many <code>@inbounds</code> already in their kernel. Note that this can lead to incorrect results, crashes, etc and is fundamentally unsafe. Be careful!</li><li><code>unsafe_indices={false, true}</code>: Disables the implicit validation of indices, users must avoid <code>@index(Global)</code>.</li></ol><ul><li><a href="#KernelAbstractions.@context"><code>@context</code></a></li></ul><div class="admonition is-category-warn" id="Warn-c3a1deb2be0868c3"><header class="admonition-header">Warn<a class="admonition-anchor" href="#Warn-c3a1deb2be0868c3" title="Permalink"></a></header><div class="admonition-body"><p>This is an experimental feature.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL56-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.@Const" href="#KernelAbstractions.@Const"><code>KernelAbstractions.@Const</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@Const(A)</code></pre><p><code>@Const</code> is an argument annotiation that asserts that the memory reference by <code>A</code> is both not written to as part of the kernel and that it does not alias any other memory in the kernel.</p><div class="admonition is-danger" id="Danger-853b40d97e3d529f"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-853b40d97e3d529f" title="Permalink"></a></header><div class="admonition-body"><p>Violating those constraints will lead to arbitrary behaviour.</p><p>As an example given a kernel signature <code>kernel(A, @Const(B))</code>, you are not allowed to call the kernel with <code>kernel(A, A)</code> or <code>kernel(A, view(A, :))</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL101-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.@index" href="#KernelAbstractions.@index"><code>KernelAbstractions.@index</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@index</code></pre><p>The <code>@index</code> macro can be used to give you the index of a workitem within a kernel function. It supports both the production of a linear index or a cartesian index. A cartesian index is a general N-dimensional index that is derived from the iteration space.</p><p><strong>Index granularity</strong></p><ul><li><code>Global</code>: Used to access global memory.</li><li><code>Group</code>: The index of the <code>workgroup</code>.</li><li><code>Local</code>: The within <code>workgroup</code> index.</li></ul><p><strong>Index kind</strong></p><ul><li><code>Linear</code>: Produces an <code>Int64</code> that can be used to linearly index into memory.</li><li><code>Cartesian</code>: Produces a <code>CartesianIndex{N}</code> that can be used to index into memory.</li><li><code>NTuple</code>: Produces a <code>NTuple{N}</code> that can be used to index into memory.</li></ul><p>If the index kind is not provided it defaults to <code>Linear</code>, this is subject to change.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">@index(Global, Linear)
@index(Global, Cartesian)
@index(Local, Cartesian)
@index(Group, Linear)
@index(Local, NTuple)
@index(Global)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL390-L421">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.@localmem" href="#KernelAbstractions.@localmem"><code>KernelAbstractions.@localmem</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@localmem T dims</code></pre><p>Declare storage that is local to a workgroup.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL232-L236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.@private" href="#KernelAbstractions.@private"><code>KernelAbstractions.@private</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@private T dims</code></pre><p>Declare storage that is local to each item in the workgroup. This can be safely used across <a href="#KernelAbstractions.@synchronize"><code>@synchronize</code></a> statements. On a CPU, this will allocate additional implicit dimensions to ensure correct localization.</p><p>For storage that only persists between <code>@synchronize</code> statements, an <code>MArray</code> can be used instead.</p><p>See also <a href="#KernelAbstractions.@uniform"><code>@uniform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL246-L257">source</a></section><section><div><pre><code class="language-julia hljs">@private mem = 1</code></pre><p>Creates a private local of <code>mem</code> per item in the workgroup. This can be safely used across <a href="#KernelAbstractions.@synchronize"><code>@synchronize</code></a> statements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL267-L272">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.@synchronize" href="#KernelAbstractions.@synchronize"><code>KernelAbstractions.@synchronize</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@synchronize()</code></pre><p>After a <code>@synchronize</code> statement all read and writes to global and local memory from each thread in the workgroup are visible in from all other threads in the workgroup.</p><div class="admonition is-info" id="Note-6c209fcc401b9031"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-6c209fcc401b9031" title="Permalink"></a></header><div class="admonition-body"><p><code>@synchronize()</code> must be encountered by all workitems of a work-group executing the kernel or by none at all.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL287-L296">source</a></section><section><div><pre><code class="language-julia hljs">@synchronize(cond)</code></pre><p>After a <code>@synchronize</code> statement all read and writes to global and local memory from each thread in the workgroup are visible in from all other threads in the workgroup. <code>cond</code> is not allowed to have any visible sideffects.</p><p><strong>Platform differences</strong></p><ul><li><code>GPU</code>: This synchronization will only occur if the <code>cond</code> evaluates.</li><li><code>CPU</code>: This synchronization will always occur.</li></ul><div class="admonition is-category-warn" id="Warn-3e1b1b82fd8e61b9"><header class="admonition-header">Warn<a class="admonition-anchor" href="#Warn-3e1b1b82fd8e61b9" title="Permalink"></a></header><div class="admonition-body"><p>This variant of the <code>@synchronize</code> macro violates the requirement that <code>@synchronize</code> must be encountered by all workitems of a work-group executing the kernel or by none at all. Since v<code>0.9.34</code> this version of the macro is deprecated and lowers to <code>@synchronize()</code></p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL303-L318">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.@print" href="#KernelAbstractions.@print"><code>KernelAbstractions.@print</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@print(items...)</code></pre><p>This is a unified print statement.</p><p><strong>Platform differences</strong></p><ul><li><code>GPU</code>: This will reorganize the items to print via <code>@cuprintf</code></li><li><code>CPU</code>: This will call <code>print(items...)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL348-L356">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.@uniform" href="#KernelAbstractions.@uniform"><code>KernelAbstractions.@uniform</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@uniform expr</code></pre><p><code>expr</code> is evaluated outside the workitem scope. This is useful for variable declarations that span workitems, or are reused across <code>@synchronize</code> statements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL277-L282">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.@groupsize" href="#KernelAbstractions.@groupsize"><code>KernelAbstractions.@groupsize</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@groupsize()</code></pre><p>Query the workgroupsize on the backend. This function returns a tuple corresponding to kernel configuration. In order to get the total size you can use <code>prod(@groupsize())</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL207-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.@ndrange" href="#KernelAbstractions.@ndrange"><code>KernelAbstractions.@ndrange</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@ndrange()</code></pre><p>Query the ndrange on the backend. This function returns a tuple corresponding to kernel configuration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL220-L225">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.synchronize" href="#KernelAbstractions.synchronize"><code>KernelAbstractions.synchronize</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">synchronize(::Backend)</code></pre><p>Synchronize the current backend.</p><div class="admonition is-info" id="Note-83960a265f6832a"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-83960a265f6832a" title="Permalink"></a></header><div class="admonition-body"><p>Backend implementations <strong>must</strong> implement this function.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL166-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.allocate" href="#KernelAbstractions.allocate"><code>KernelAbstractions.allocate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">allocate(::Backend, Type, dims...)::AbstractArray</code></pre><p>Allocate a storage array appropriate for the computational backend.</p><div class="admonition is-info" id="Note-b9f1093faaf9b282"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-b9f1093faaf9b282" title="Permalink"></a></header><div class="admonition-body"><p>Backend implementations <strong>must</strong> implement <code>allocate(::NewBackend, T, dims::Tuple)</code></p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL534-L541">source</a></section></article><h2 id="Host-language"><a class="docs-heading-anchor" href="#Host-language">Host language</a><a id="Host-language-1"></a><a class="docs-heading-anchor-permalink" href="#Host-language" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.zeros" href="#KernelAbstractions.zeros"><code>KernelAbstractions.zeros</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">zeros(::Backend, Type, dims...)::AbstractArray</code></pre><p>Allocate a storage array appropriate for the computational backend filled with zeros.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL545-L549">source</a></section></article><h2 id="Internal"><a class="docs-heading-anchor" href="#Internal">Internal</a><a id="Internal-1"></a><a class="docs-heading-anchor-permalink" href="#Internal" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.Kernel" href="#KernelAbstractions.Kernel"><code>KernelAbstractions.Kernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Kernel{Backend, WorkgroupSize, NDRange, Func}</code></pre><p>Kernel closure struct that is used to represent the backend kernel on the host. <code>WorkgroupSize</code> is the number of workitems in a workgroup.</p><div class="admonition is-info" id="Note-d635007a321edae4"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-d635007a321edae4" title="Permalink"></a></header><div class="admonition-body"><p>Backend implementations <strong>must</strong> implement:</p><pre><code class="nohighlight hljs">(kernel::Kernel{&lt;:NewBackend})(args...; ndrange=nothing, workgroupsize=nothing)</code></pre><p>As well as the on-device functionality.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL665-L678">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.partition" href="#KernelAbstractions.partition"><code>KernelAbstractions.partition</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Partition a kernel for the given ndrange and workgroupsize.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL692-L694">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KernelAbstractions.@context" href="#KernelAbstractions.@context"><code>KernelAbstractions.@context</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@context()</code></pre><p>Access the hidden context object used by KernelAbstractions.</p><div class="admonition is-category-warn" id="Warn-29c4d20db3081d86"><header class="admonition-header">Warn<a class="admonition-anchor" href="#Warn-29c4d20db3081d86" title="Permalink"></a></header><div class="admonition-body"><p>Only valid to be used from a kernel with <code>cpu=false</code>.</p></div></div><pre><code class="nohighlight hljs">function f(@context, a)
    I = @index(Global, Linear)
    a[I]
end

@kernel cpu=false function my_kernel(a)
    f(@context, a)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGPU/KernelAbstractions.jl/blob/434d55a0354d46d87fc0a741b77c6acf730c113d/src/KernelAbstractions.jl#LL325-L343">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/atomix/">« Atomic operations with Atomix.jl</a><a class="docs-footer-nextpage" href="../extras/unrolling/">Unroll macro »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 11 July 2025 14:05">Friday 11 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
